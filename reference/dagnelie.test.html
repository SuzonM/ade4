<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Compute Dagnelie test of multivariate normality on a data table of n objects (rows) and p variables (columns), with n &amp;gt; (p+1)."><title>Dagnelie multinormality test — dagnelie.test • ade4</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dagnelie multinormality test — dagnelie.test"><meta property="og:description" content="Compute Dagnelie test of multivariate normality on a data table of n objects (rows) and p variables (columns), with n &amp;gt; (p+1)."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ade4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-22</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-new-to-ade-">New to ade4 ?</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-new-to-ade-">
    <a class="dropdown-item" href="../articles/install.html">Installation</a>
    <a class="dropdown-item" href="../articles/get_started.html">Getting started</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/ChapEnvVarStruct.html">Environmental variables structures</a>
    <a class="dropdown-item" href="../articles/ChapSpeciesStruct.html">Species structures</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/related.html">Related packages</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-ressources">Ressources</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-ressources">
    <a class="dropdown-item" href="../articles/faq.html">FAQ</a>
    <a class="external-link dropdown-item" href="https://listes.univ-lyon1.fr/sympa/info/adelist">adelist</a>
    <a class="dropdown-item" href="../articles/book.html">Ade4 book</a>
    <a class="dropdown-item" href="../articles/papers.html">Papers</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://lbbe-web.univ-lyon1.fr/en">
    <span class="fa fa-leaf"></span>
     
    LBBE
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sdray/ade4">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Dagnelie multinormality test</h1>
      
      <div class="d-none name"><code>dagnelie.test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute Dagnelie test of multivariate normality on a data table of n objects (rows) and p variables (columns), with n &gt; (p+1).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dagnelie.test</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Multivariate data table (<code>matrix</code> or <code>data.frame</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following results:</p>
<dl><dt>Shapiro.Wilk</dt>
<dd><p>W statistic and p-value</p></dd>

<dt>dim</dt>
<dd><p>dimensions of the data matrix, n and p</p></dd>

<dt>rank</dt>
<dd><p>the rank of the covariance matrix</p></dd>

<dt>D</dt>
<dd><p>Vector containing the Mahalanobis distances of the objects to the multivariate centroid</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Dagnelie's goodness-of-fit test of multivariate normality is applicable to 
 multivariate data. Mahalanobis generalized distances are computed between each object and the multivariate centroid of all objects. Dagnelie’s approach is that, for multinormal data, the generalized distances should be normally distributed. The function computes a Shapiro-Wilk test of normality of the Mahalanobis distances; this is our improvement of Dagnelie’s method. 
The null hypothesis (H0) is that the data are multinormal, a situation where the Mahalanobis distances should be normally distributed. In that case, the test should not reject H0, subject to type I error at the selected significance level. <br></p>
<p>Numerical simulations by D. Borcard have shown that the test had correct levels of type I error for values of n between 3p and 8p, where n is the number of objects and p is the number of variables in the data 
 matrix (simulations with 1 &lt;= p &lt;= 100). Outside that range of n values, the results were too liberal, meaning that the test rejected too often the null hypothesis of normality. For p = 2, the simulations showed the test to be valid for 6 &lt;= n &lt;= 13 and too liberal outside that range. If H0 is not rejected in a situation where the test is too liberal, the result is trustworthy.<br></p>
<p>Calculation of the Mahalanobis distances requires that n &gt; p+1 (actually, n &gt; rank+1). With fewer objects (n), all points are at equal Mahalanobis distances from the centroid in the resulting space, which has <code>min(rank,(n-1))</code> dimensions. For data matrices that happen to be collinear, the function uses <code>ginv</code> for inversion.<br></p>
<p>This test is not meant to be used with univariate data; in simulations, the type I error rate was higher than the 5% significance level for all values of n. Function <code>shapiro.test</code> should be used in that situation.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Dagnelie, P. 1975. L'analyse statistique a plusieurs variables. 
 Les Presses agronomiques de Gembloux, Gembloux, Belgium.<br></p>
<p>Legendre, P. and L. Legendre. 2012. Numerical ecology, 3rd English
 edition. Elsevier Science BV, Amsterdam, The Netherlands.<br></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Daniel Borcard and Pierre Legendre</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Example 1: 2 variables, n = 100</span></span></span>
<span class="r-in"><span> <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>; <span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span> <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">(</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">dagnelie.test</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Test too liberal, n &gt; 8*p</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Test too liberal, p = 2, n &gt; 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Shapiro.Wilk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Shapiro-Wilk normality test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> W = 0.97904, p-value = 0.1118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n   p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100   2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 0.57936211 1.37567204 0.55801826 1.01650349 2.50391174 1.98615148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [7] 2.00419371 1.07835918 0.84563457 2.19962034 2.11726869 1.41060954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [13] 1.35099398 1.54508594 1.12167923 1.52669158 0.76182490 1.27545524</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [19] 1.34904448 1.62120091 0.84055302 1.05808296 1.74335572 1.25962735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25] 1.49007808 1.07222868 0.57271390 1.26404737 2.69477870 1.00662884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [31] 1.48067928 0.70997500 1.82786798 0.48255553 1.88777255 2.33681859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [37] 0.74934323 0.76419523 0.99768308 0.99942799 0.98882404 0.78285530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [43] 0.89716342 1.42507288 0.88824467 2.88342086 1.34769239 0.95099151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49] 0.85008684 0.74951222 2.28269199 2.01598800 0.08046148 1.73394532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [55] 1.17481278 1.08854051 0.41393999 1.89481131 0.77084770 0.62575626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [61] 1.02487542 2.07576934 1.24023564 1.78253896 0.31652152 1.51837440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [67] 0.88594037 0.56438783 0.74574818 0.76620769 1.20020739 1.02154608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] 0.79711278 0.89746071 1.78084215 2.01294347 0.07689940 0.40694649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [79] 1.86014930 1.65942962 1.15496543 1.36564230 1.97394762 0.97717814</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [85] 0.31542804 1.14191245 1.90081107 0.76208530 2.12340078 0.91309800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91] 0.82631469 1.63040697 1.87582045 2.33588105 1.77191686 0.16941906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97] 0.56530976 1.81612184 1.28643481 2.22477451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Example 2: 10 variables, n = 50</span></span></span>
<span class="r-in"><span> <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span>; <span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span> <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">(</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">dagnelie.test</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Test too liberal, n &gt; 8*p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Shapiro.Wilk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Shapiro-Wilk normality test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> W = 0.96144, p-value = 0.1021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  n  p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 4.164243 3.398896 3.198412 2.534409 3.469737 2.163160 2.291549 1.964425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] 2.284314 3.772753 3.464714 2.885716 2.605905 3.776695 2.453068 3.592838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] 3.683776 4.035398 2.438034 3.097863 3.534965 2.585633 3.741282 3.447684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] 3.525482 3.462619 2.679883 3.125146 2.863274 3.441471 2.894053 1.498945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33] 3.602816 3.454636 2.500460 3.507321 2.797005 3.002237 3.402564 3.446196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41] 2.802506 2.638909 2.743499 3.763643 2.372428 3.415087 2.888745 3.651433</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49] 3.307456 2.488497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Example 3: 10 variables, n = 100</span></span></span>
<span class="r-in"><span> <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>; <span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span> <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">(</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">dagnelie.test</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Test too liberal, n &gt; 8*p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Shapiro.Wilk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Shapiro-Wilk normality test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> W = 0.98458, p-value = 0.2959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n   p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100  10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 2.590934 1.961678 3.174177 2.846720 4.518773 3.574530 2.818996 3.418948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [9] 2.031906 3.036525 2.736304 2.522499 3.037277 3.793278 2.639677 4.477188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [17] 3.225093 3.542811 2.892423 3.436737 3.694029 2.807040 2.686611 3.120196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25] 3.871227 2.244351 3.486795 3.570227 1.891070 2.857932 3.673195 2.993854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [33] 2.220566 2.299953 1.651510 3.499132 1.593396 3.402346 2.402565 3.284407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [41] 3.587964 2.828008 3.271869 2.137454 2.908863 2.878416 3.868277 2.257499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49] 3.059304 3.671701 1.954451 2.696279 3.209557 4.135940 2.123605 3.510752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [57] 2.785618 2.372523 3.936190 3.087179 4.090735 1.778159 2.581494 4.062386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [65] 3.382731 3.573792 2.181758 2.355531 2.804370 4.040258 4.694370 1.616734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] 4.896582 3.382418 2.439543 3.321253 3.368602 3.629736 3.278560 5.615007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [81] 3.203537 3.562819 3.493611 3.625061 3.112810 2.539039 4.082832 1.491573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [89] 3.396067 2.668885 2.424217 2.616985 2.075035 2.624964 3.273317 3.534882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97] 3.184620 2.322049 2.218208 3.043121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span> <span class="co"># Plot a histogram of the Mahalanobis distances</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">D</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="dagnelie.test-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Example 4: 10 lognormal random variables, n = 50</span></span></span>
<span class="r-in"><span> <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span>; <span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span> <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">(</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">dagnelie.test</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Test too liberal, n &gt; 8*p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Shapiro.Wilk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Shapiro-Wilk normality test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> W = 0.69782, p-value = 7.566e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  n  p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 6.1405513 1.0090227 0.9857501 6.6920605 2.2519663 0.7476556 1.1477333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 6.5408275 2.0845090 1.1810982 1.3287769 3.7724512 0.8787270 0.9280586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 1.1003176 1.5569449 0.8582185 0.9577747 1.0005851 1.5745925 0.9608340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22] 1.0083936 2.0905497 0.8578349 2.9938136 0.8059606 0.7895094 0.9397788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29] 1.6608903 1.0279386 2.1457637 1.3697309 6.4225324 0.7334127 6.5112561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36] 0.9038927 0.7335196 0.8725145 1.2027327 0.7801169 1.3510378 6.8913459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43] 2.1752362 2.7135221 6.7009223 4.0420115 6.6956896 0.9244192 0.9689303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [50] 6.1284414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span> <span class="co"># Plot a histogram of the Mahalanobis distances</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">D</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="dagnelie.test-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Stéphane Dray, Anne-Béatrice Dufour, Jean Thioulouse, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

